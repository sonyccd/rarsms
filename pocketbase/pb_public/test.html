<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RARSMS Frontend Unit Tests</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .test-header {
            text-align: center;
            color: #333;
            border-bottom: 2px solid #007AFF;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        .test-suite {
            margin-bottom: 30px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
        }
        .test-suite h3 {
            margin: 0 0 15px 0;
            color: #333;
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            margin: -15px -15px 15px -15px;
        }
        .test-case {
            padding: 8px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        .test-case:last-child {
            border-bottom: none;
        }
        .test-pass {
            color: #28a745;
        }
        .test-fail {
            color: #dc3545;
            font-weight: bold;
        }
        .test-skip {
            color: #ffc107;
        }
        .summary {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            font-size: 18px;
            font-weight: bold;
        }
        .summary.pass {
            background: #d4edda;
            color: #155724;
        }
        .summary.fail {
            background: #f8d7da;
            color: #721c24;
        }
        pre {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 14px;
        }
        .run-tests-btn {
            background: #007AFF;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin: 20px 0;
        }
        .run-tests-btn:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div id="access-check" class="test-header">
            <h1>üß™ RARSMS Frontend Unit Tests</h1>
            <p><strong>Development Environment Only</strong></p>
            <p>Comprehensive testing suite covering Bootstrap 5 integration, dark theme, responsive design, and UI components.</p>
            <div id="environment-warning" style="background: #f8d7da; color: #721c24; padding: 15px; border-radius: 8px; margin: 20px 0; border: 1px solid #f5c6cb;">
                <strong>‚ö†Ô∏è Security Notice:</strong> If you can access this page in a production environment,
                please ensure the test.html file is properly restricted or removed from production deployments.
            </div>
            <div style="background: #d1ecf1; color: #0c5460; padding: 15px; border-radius: 8px; margin: 20px 0; border: 1px solid #b8daff;">
                <strong>üìã Test Coverage:</strong>
                <ul style="margin: 10px 0 0 20px; padding: 0;">
                    <li>Authentication & Role Management</li>
                    <li>Configuration Management</li>
                    <li>Callsign Validation & Management</li>
                    <li>Bootstrap 5 Integration & Components</li>
                    <li>Dark Theme & Color Palette</li>
                    <li>Responsive Design & Mobile Support</li>
                    <li>Modal Integration & Accessibility</li>
                    <li>Form Validation & UI Components</li>
                    <li>Performance & Optimization</li>
                </ul>
            </div>
            <button class="run-tests-btn" onclick="runAllTests()">Run All Tests (35+ Test Cases)</button>
        </div>

        <div id="test-results"></div>

        <div id="test-summary"></div>
    </div>

    <!-- Load PocketBase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/pocketbase@0.21.1/dist/pocketbase.umd.js"></script>

    <!-- Load the main app (for testing) -->
    <script>
        // Mock PocketBase for testing
        const mockPB = {
            authStore: {
                isValid: false,
                token: '',
                model: null,
                clear: () => {},
                save: () => {}
            },
            collection: (name) => ({
                getFullList: () => Promise.resolve([]),
                getList: () => Promise.resolve({ items: [] }),
                create: () => Promise.resolve({ id: 'test123' }),
                update: () => Promise.resolve({ id: 'test123' }),
                delete: () => Promise.resolve(true),
                authWithPassword: (email, password) => {
                    if (email === 'admin@test.com' && password === 'admin123') {
                        return Promise.resolve({
                            record: { id: '123', email: 'admin@test.com', role: 'admin' },
                            token: 'mock-token'
                        });
                    } else if (email === 'user@test.com' && password === 'user123') {
                        return Promise.resolve({
                            record: { id: '456', email: 'user@test.com', role: 'user' },
                            token: 'mock-token'
                        });
                    } else {
                        return Promise.reject(new Error('Invalid credentials'));
                    }
                }
            })
        };
    </script>

    <script>
        // Simple test framework
        class TestRunner {
            constructor() {
                this.tests = [];
                this.results = [];
                this.currentSuite = null;
            }

            describe(suiteName, callback) {
                this.currentSuite = suiteName;
                callback();
            }

            it(testName, testFunction) {
                this.tests.push({
                    suite: this.currentSuite,
                    name: testName,
                    fn: testFunction
                });
            }

            async runTests() {
                this.results = [];
                const testResults = document.getElementById('test-results');
                testResults.innerHTML = '';

                // Group tests by suite
                const suites = {};
                this.tests.forEach(test => {
                    if (!suites[test.suite]) {
                        suites[test.suite] = [];
                    }
                    suites[test.suite].push(test);
                });

                // Run tests suite by suite
                for (const [suiteName, tests] of Object.entries(suites)) {
                    const suiteDiv = document.createElement('div');
                    suiteDiv.className = 'test-suite';
                    suiteDiv.innerHTML = `<h3>${suiteName}</h3>`;

                    for (const test of tests) {
                        const result = await this.runSingleTest(test);
                        this.results.push(result);

                        const testDiv = document.createElement('div');
                        testDiv.className = 'test-case';
                        testDiv.innerHTML = `
                            <span class="test-${result.status}">
                                ${result.status === 'pass' ? '‚úÖ' : result.status === 'fail' ? '‚ùå' : '‚ö†Ô∏è'}
                                ${test.name}
                            </span>
                            ${result.error ? `<pre>${result.error}</pre>` : ''}
                        `;
                        suiteDiv.appendChild(testDiv);
                    }

                    testResults.appendChild(suiteDiv);
                }

                this.showSummary();
            }

            async runSingleTest(test) {
                try {
                    await test.fn();
                    return { status: 'pass', error: null };
                } catch (error) {
                    return { status: 'fail', error: error.message };
                }
            }

            showSummary() {
                const summary = document.getElementById('test-summary');
                const passed = this.results.filter(r => r.status === 'pass').length;
                const failed = this.results.filter(r => r.status === 'fail').length;
                const total = this.results.length;

                const summaryClass = failed === 0 ? 'pass' : 'fail';
                summary.innerHTML = `
                    <div class="summary ${summaryClass}">
                        Tests: ${total} | Passed: ${passed} | Failed: ${failed} | Success Rate: ${Math.round((passed/total)*100)}%
                    </div>
                `;
            }

            // Assertion helpers
            expect(actual) {
                return {
                    toBe: (expected) => {
                        if (actual !== expected) {
                            throw new Error(`Expected ${expected}, got ${actual}`);
                        }
                    },
                    toBeTruthy: () => {
                        if (!actual) {
                            throw new Error(`Expected truthy value, got ${actual}`);
                        }
                    },
                    toBeFalsy: () => {
                        if (actual) {
                            throw new Error(`Expected falsy value, got ${actual}`);
                        }
                    },
                    toThrow: () => {
                        try {
                            actual();
                            throw new Error('Expected function to throw');
                        } catch (e) {
                            // Expected
                        }
                    },
                    toContain: (expected) => {
                        if (!actual.includes(expected)) {
                            throw new Error(`Expected ${actual} to contain ${expected}`);
                        }
                    }
                };
            }
        }

        const testRunner = new TestRunner();
        const { describe, it, expect } = testRunner;

        // Authentication Tests
        describe('Authentication Logic', () => {
            it('should identify admin users correctly', async () => {
                const user = { role: 'admin', email: 'test@admin.com' };
                const isAdmin = user.role === 'admin';
                expect(isAdmin).toBeTruthy();
            });

            it('should identify regular users correctly', async () => {
                const user = { role: 'user', email: 'test@user.com' };
                const isAdmin = user.role === 'admin';
                expect(isAdmin).toBeFalsy();
            });

            it('should handle missing role field', async () => {
                const user = { email: 'test@user.com' };
                const isAdmin = user.role === 'admin';
                expect(isAdmin).toBeFalsy();
            });

            it('should authenticate admin user with mock PB', async () => {
                const authData = await mockPB.collection('users').authWithPassword('admin@test.com', 'admin123');
                expect(authData.record.role).toBe('admin');
            });

            it('should authenticate regular user with mock PB', async () => {
                const authData = await mockPB.collection('users').authWithPassword('user@test.com', 'user123');
                expect(authData.record.role).toBe('user');
            });

            it('should reject invalid credentials', async () => {
                try {
                    await mockPB.collection('users').authWithPassword('invalid@test.com', 'wrong');
                    expect(false).toBeTruthy(); // Should not reach here
                } catch (error) {
                    expect(error.message).toBe('Invalid credentials');
                }
            });
        });

        // Configuration Management Tests
        describe('Configuration Management', () => {
            it('should validate APRS server configuration', () => {
                const config = {
                    aprs_server: 'rotate.aprs2.net',
                    aprs_port: 14580,
                    aprs_callsign: 'TEST',
                    aprs_passcode: '12345'
                };

                expect(config.aprs_server).toBeTruthy();
                expect(config.aprs_port).toBe(14580);
                expect(config.aprs_callsign).toBeTruthy();
                expect(config.aprs_passcode).toBeTruthy();
            });

            it('should validate Discord configuration', () => {
                const config = {
                    discord_bot_token: 'test-token',
                    discord_channel_id: '123456789',
                    discord_guild_id: '987654321'
                };

                expect(config.discord_bot_token).toBeTruthy();
                expect(config.discord_channel_id).toBeTruthy();
                expect(config.discord_guild_id).toBeTruthy();
            });

            it('should handle default configuration values', () => {
                const defaultConfig = {
                    aprs_server: 'rotate.aprs2.net',
                    aprs_port: 14580,
                    filter_lat: 35.7796,
                    filter_lon: -78.6382,
                    filter_distance: 100,
                    pocketbase_url: 'http://pocketbase:8090'
                };

                expect(defaultConfig.aprs_server).toBe('rotate.aprs2.net');
                expect(defaultConfig.aprs_port).toBe(14580);
                expect(defaultConfig.filter_distance).toBe(100);
            });
        });

        // Callsign Management Tests
        describe('Callsign Management', () => {
            it('should validate callsign format', () => {
                const validCallsigns = ['KK4PWJ', 'W1AW', 'N0CALL', 'AA1A'];
                const invalidCallsigns = ['', '123', 'toolongcallsign', 'k!k$'];

                validCallsigns.forEach(callsign => {
                    const isValid = /^[A-Za-z0-9]{3,7}$/.test(callsign);
                    expect(isValid).toBeTruthy();
                });

                invalidCallsigns.forEach(callsign => {
                    const isValid = /^[A-Za-z0-9]{3,7}$/.test(callsign);
                    expect(isValid).toBeFalsy();
                });
            });

            it('should convert callsigns to uppercase', () => {
                const lowercase = 'kk4pwj';
                const uppercase = lowercase.toUpperCase();
                expect(uppercase).toBe('KK4PWJ');
            });

            it('should create callsign objects correctly', () => {
                const callsign = {
                    callsign: 'KK4PWJ',
                    description: 'Test callsign',
                    enabled: true
                };

                expect(callsign.callsign).toBe('KK4PWJ');
                expect(callsign.description).toBeTruthy();
                expect(callsign.enabled).toBeTruthy();
            });
        });

        // Frontend Validation Tests
        describe('Frontend Validation', () => {
            it('should validate email format', () => {
                const validEmails = ['test@example.com', 'user+tag@domain.co.uk', 'admin@rarsms.local'];
                const invalidEmails = ['invalid-email', '@domain.com', 'user@', 'user@domain'];

                validEmails.forEach(email => {
                    const isValid = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
                    expect(isValid).toBeTruthy();
                });

                invalidEmails.forEach(email => {
                    const isValid = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
                    expect(isValid).toBeFalsy();
                });
            });

            it('should validate password length', () => {
                const validPasswords = ['password123', 'strongPassword!', 'admin123'];
                const invalidPasswords = ['123', '', 'short'];

                validPasswords.forEach(password => {
                    const isValid = password.length >= 8;
                    expect(isValid).toBeTruthy();
                });

                invalidPasswords.forEach(password => {
                    const isValid = password.length >= 8;
                    expect(isValid).toBeFalsy();
                });
            });

            it('should validate numeric inputs', () => {
                const validNumbers = [14580, 100, 35.7796, -78.6382];
                const invalidNumbers = ['not-a-number', '', null, undefined];

                validNumbers.forEach(num => {
                    const isValid = !isNaN(parseFloat(num)) && isFinite(num);
                    expect(isValid).toBeTruthy();
                });

                invalidNumbers.forEach(num => {
                    const isValid = !isNaN(parseFloat(num)) && isFinite(num);
                    expect(isValid).toBeFalsy();
                });
            });
        });

        // Message Statistics Tests
        describe('Message Statistics', () => {
            it('should calculate message statistics correctly', () => {
                const messages = [
                    { source_protocol: 'aprs', message_type: 'position', created: new Date().toISOString() },
                    { source_protocol: 'aprs', message_type: 'message', created: new Date().toISOString() },
                    { source_protocol: 'discord', message_type: 'text', created: '2024-01-01T00:00:00.000Z' }
                ];

                const today = new Date().toDateString();
                const stats = {
                    total: messages.length,
                    today: messages.filter(msg => new Date(msg.created).toDateString() === today).length,
                    protocols: {},
                    types: {}
                };

                messages.forEach(msg => {
                    const protocol = msg.source_protocol?.replace('_main', '') || 'unknown';
                    stats.protocols[protocol] = (stats.protocols[protocol] || 0) + 1;
                    stats.types[msg.message_type] = (stats.types[msg.message_type] || 0) + 1;
                });

                expect(stats.total).toBe(3);
                expect(stats.today).toBe(2);
                expect(stats.protocols.aprs).toBe(2);
                expect(stats.protocols.discord).toBe(1);
                expect(stats.types.position).toBe(1);
                expect(stats.types.message).toBe(1);
                expect(stats.types.text).toBe(1);
            });
        });

        // Bootstrap 5 Integration Tests
        describe('Bootstrap 5 Integration', () => {
            it('should have Bootstrap 5 CSS loaded', () => {
                const bootstrapLinks = Array.from(document.querySelectorAll('link[href*="bootstrap"]'));
                const hasBootstrap = bootstrapLinks.some(link =>
                    link.href.includes('bootstrap@5') || link.href.includes('bootstrap/5')
                );
                expect(hasBootstrap).toBeTruthy();
            });

            it('should have Bootstrap Icons loaded', () => {
                const iconLinks = Array.from(document.querySelectorAll('link[href*="bootstrap-icons"]'));
                expect(iconLinks.length).toBe(1);
            });

            it('should use Bootstrap modal classes', () => {
                // Test modal structure exists in HTML
                const modalElement = document.querySelector('.modal');
                if (modalElement) {
                    expect(modalElement.classList.contains('fade')).toBeTruthy();
                }
                // If no modal in DOM, test passes as modals are created dynamically
                expect(true).toBeTruthy();
            });

            it('should have Bootstrap JS loaded', () => {
                const bootstrapScripts = Array.from(document.querySelectorAll('script[src*="bootstrap"]'));
                const hasBootstrapJS = bootstrapScripts.some(script =>
                    script.src.includes('bootstrap@5') || script.src.includes('bootstrap/5')
                );
                expect(hasBootstrapJS).toBeTruthy();
            });

            it('should use Bootstrap form classes', () => {
                // Test if Bootstrap form classes are available in CSS
                const testElement = document.createElement('input');
                testElement.className = 'form-control';
                document.body.appendChild(testElement);

                const computedStyle = window.getComputedStyle(testElement);
                const hasBootstrapStyling = computedStyle.display !== '' || computedStyle.padding !== '';

                document.body.removeChild(testElement);
                expect(hasBootstrapStyling).toBeTruthy();
            });
        });

        // UI Component Tests
        describe('UI Component Structure', () => {
            it('should have sidebar navigation with proper classes', () => {
                // These elements should exist in the main application
                const sidebarClasses = ['sidebar', 'sidebar-nav', 'nav-item', 'nav-tab'];
                sidebarClasses.forEach(className => {
                    // Test that the class would be valid
                    expect(className).toContain('sidebar');
                });
            });

            it('should use card components for configuration forms', () => {
                // Test card structure
                const cardHTML = `
                    <div class="card mb-4">
                        <div class="card-header bg-secondary text-white">
                            <h5 class="card-title mb-1">Test Card</h5>
                        </div>
                        <div class="card-body">Content</div>
                    </div>
                `;

                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = cardHTML;

                const card = tempDiv.querySelector('.card');
                const cardHeader = tempDiv.querySelector('.card-header');
                const cardBody = tempDiv.querySelector('.card-body');

                expect(card).toBeTruthy();
                expect(cardHeader).toBeTruthy();
                expect(cardBody).toBeTruthy();
                expect(cardHeader.classList.contains('bg-secondary')).toBeTruthy();
            });

            it('should use responsive grid for callsign cards', () => {
                // Test responsive column classes
                const responsiveHTML = `
                    <div class="row">
                        <div class="col-lg-6 col-xl-4 mb-3">
                            <div class="card h-100">Content</div>
                        </div>
                    </div>
                `;

                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = responsiveHTML;

                const row = tempDiv.querySelector('.row');
                const col = tempDiv.querySelector('.col-lg-6');
                const card = tempDiv.querySelector('.card.h-100');

                expect(row).toBeTruthy();
                expect(col).toBeTruthy();
                expect(card).toBeTruthy();
                expect(col.classList.contains('col-xl-4')).toBeTruthy();
            });

            it('should use Bootstrap icons instead of emojis', () => {
                // Test Bootstrap icon structure
                const iconHTML = '<i class="bi bi-broadcast me-2"></i>';
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = iconHTML;

                const icon = tempDiv.querySelector('.bi');
                expect(icon).toBeTruthy();
                expect(icon.classList.contains('bi-broadcast')).toBeTruthy();
                expect(icon.classList.contains('me-2')).toBeTruthy();
            });
        });

        // Dark Theme Tests
        describe('Dark Theme Integration', () => {
            it('should have dark theme enabled on body', () => {
                // Check if body has dark theme attribute
                const body = document.body;
                const hasDataBsTheme = body.hasAttribute('data-bs-theme');
                if (hasDataBsTheme) {
                    expect(body.getAttribute('data-bs-theme')).toBe('dark');
                } else {
                    // Test passes if no theme attribute (uses CSS for dark theme)
                    expect(true).toBeTruthy();
                }
            });

            it('should use muted colors instead of bright blue', () => {
                // Test that secondary color is used instead of primary
                const testButton = document.createElement('button');
                testButton.className = 'btn btn-secondary';
                document.body.appendChild(testButton);

                expect(testButton.classList.contains('btn-secondary')).toBeTruthy();
                expect(!testButton.classList.contains('btn-primary')).toBeTruthy();

                document.body.removeChild(testButton);
            });

            it('should use proper contrast colors for dark theme', () => {
                // Test background colors are dark-appropriate
                const colors = {
                    sidebar: '#2d3748',
                    feedHeader: '#4a5568',
                    background: '#1a1a1a'
                };

                Object.keys(colors).forEach(key => {
                    const colorValue = colors[key];
                    expect(colorValue).toContain('#');
                    expect(colorValue.length).toBe(7); // Hex color format
                });
            });
        });

        // Form Validation Tests
        describe('Enhanced Form Validation', () => {
            it('should validate Bootstrap form controls', () => {
                // Test Bootstrap form structure
                const formHTML = `
                    <div class="mb-3">
                        <label for="test-input" class="form-label">Test Input</label>
                        <input type="text" class="form-control" id="test-input" required>
                        <div class="form-text">Help text</div>
                    </div>
                `;

                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = formHTML;

                const formGroup = tempDiv.querySelector('.mb-3');
                const label = tempDiv.querySelector('.form-label');
                const input = tempDiv.querySelector('.form-control');
                const helpText = tempDiv.querySelector('.form-text');

                expect(formGroup).toBeTruthy();
                expect(label).toBeTruthy();
                expect(input).toBeTruthy();
                expect(helpText).toBeTruthy();
            });

            it('should handle checkbox form controls', () => {
                // Test Bootstrap checkbox structure
                const checkboxHTML = `
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="test-check">
                        <label class="form-check-label" for="test-check">
                            Test Checkbox
                        </label>
                    </div>
                `;

                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = checkboxHTML;

                const formCheck = tempDiv.querySelector('.form-check');
                const checkboxInput = tempDiv.querySelector('.form-check-input');
                const checkboxLabel = tempDiv.querySelector('.form-check-label');

                expect(formCheck).toBeTruthy();
                expect(checkboxInput).toBeTruthy();
                expect(checkboxLabel).toBeTruthy();
            });

            it('should use input groups for enhanced inputs', () => {
                // Test Bootstrap input group structure
                const inputGroupHTML = `
                    <div class="input-group">
                        <input type="number" class="form-control">
                        <span class="input-group-text">seconds</span>
                    </div>
                `;

                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = inputGroupHTML;

                const inputGroup = tempDiv.querySelector('.input-group');
                const input = tempDiv.querySelector('.form-control');
                const groupText = tempDiv.querySelector('.input-group-text');

                expect(inputGroup).toBeTruthy();
                expect(input).toBeTruthy();
                expect(groupText).toBeTruthy();
                expect(groupText.textContent).toBe('seconds');
            });
        });

        // Modal Integration Tests
        describe('Bootstrap Modal Integration', () => {
            it('should create proper Bootstrap modal structure', () => {
                // Test modal HTML structure
                const modalHTML = `
                    <div class="modal fade" id="test-modal" tabindex="-1">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header bg-secondary text-white">
                                    <h5 class="modal-title">Test Modal</h5>
                                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                                </div>
                                <div class="modal-body">Content</div>
                            </div>
                        </div>
                    </div>
                `;

                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = modalHTML;

                const modal = tempDiv.querySelector('.modal');
                const modalDialog = tempDiv.querySelector('.modal-dialog');
                const modalContent = tempDiv.querySelector('.modal-content');
                const modalHeader = tempDiv.querySelector('.modal-header');
                const modalBody = tempDiv.querySelector('.modal-body');
                const closeButton = tempDiv.querySelector('.btn-close');

                expect(modal).toBeTruthy();
                expect(modal.classList.contains('fade')).toBeTruthy();
                expect(modalDialog).toBeTruthy();
                expect(modalContent).toBeTruthy();
                expect(modalHeader).toBeTruthy();
                expect(modalHeader.classList.contains('bg-secondary')).toBeTruthy();
                expect(modalBody).toBeTruthy();
                expect(closeButton).toBeTruthy();
                expect(closeButton.classList.contains('btn-close-white')).toBeTruthy();
            });

            it('should have proper modal accessibility attributes', () => {
                const modalHTML = `
                    <div class="modal fade" id="test-modal" tabindex="-1" aria-labelledby="testModalLabel" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="testModalLabel">Test Modal</h5>
                                </div>
                            </div>
                        </div>
                    </div>
                `;

                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = modalHTML;

                const modal = tempDiv.querySelector('.modal');
                const modalTitle = tempDiv.querySelector('.modal-title');

                expect(modal.getAttribute('tabindex')).toBe('-1');
                expect(modal.getAttribute('aria-labelledby')).toBe('testModalLabel');
                expect(modal.getAttribute('aria-hidden')).toBe('true');
                expect(modalTitle.id).toBe('testModalLabel');
            });

            it('should handle Bootstrap modal API calls', () => {
                // Test that bootstrap object would be available
                expect(typeof bootstrap !== 'undefined' || typeof window.bootstrap !== 'undefined').toBeTruthy();
            });
        });

        // Responsive Design Tests
        describe('Responsive Design', () => {
            it('should use Bootstrap responsive classes', () => {
                const responsiveClasses = [
                    'col-md-6', 'col-lg-4', 'col-xl-3',
                    'd-flex', 'justify-content-between', 'align-items-center',
                    'mb-3', 'me-2', 'ms-2', 'p-3'
                ];

                responsiveClasses.forEach(className => {
                    expect(className).toBeTruthy();
                    expect(typeof className).toBe('string');
                    expect(className.length).toBeGreaterThan(0);
                });
            });

            it('should handle mobile-first responsive design', () => {
                // Test that viewport meta tag exists
                const viewportMeta = document.querySelector('meta[name="viewport"]');
                expect(viewportMeta).toBeTruthy();
                if (viewportMeta) {
                    expect(viewportMeta.getAttribute('content')).toContain('width=device-width');
                    expect(viewportMeta.getAttribute('content')).toContain('initial-scale=1.0');
                }
            });

            it('should use Bootstrap spacing utilities', () => {
                // Test spacing utility classes
                const spacingHTML = `
                    <div class="mb-3 p-2">
                        <div class="me-2 ms-1">Content</div>
                    </div>
                `;

                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = spacingHTML;

                const container = tempDiv.querySelector('.mb-3');
                const content = tempDiv.querySelector('.me-2');

                expect(container).toBeTruthy();
                expect(container.classList.contains('p-2')).toBeTruthy();
                expect(content).toBeTruthy();
                expect(content.classList.contains('ms-1')).toBeTruthy();
            });
        });

        // Performance and Optimization Tests
        describe('Performance Optimizations', () => {
            it('should load Bootstrap from CDN efficiently', () => {
                const cdnLinks = Array.from(document.querySelectorAll('link[href*="cdn.jsdelivr"]'));
                const cdnScripts = Array.from(document.querySelectorAll('script[src*="cdn.jsdelivr"]'));

                expect(cdnLinks.length).toBeGreaterThan(0);
                expect(cdnScripts.length).toBeGreaterThan(0);
            });

            it('should use efficient CSS class combinations', () => {
                // Test that common Bootstrap class combinations are efficient
                const efficientClasses = [
                    'd-flex justify-content-between align-items-center',
                    'card mb-4',
                    'btn btn-secondary',
                    'form-control'
                ];

                efficientClasses.forEach(classString => {
                    const classes = classString.split(' ');
                    expect(classes.length).toBeGreaterThan(0);
                    expect(classes.every(cls => cls.length > 0)).toBeTruthy();
                });
            });

            it('should minimize custom CSS with Bootstrap utilities', () => {
                // Test that we're using Bootstrap utilities instead of custom CSS
                const utilityClasses = [
                    'text-white', 'text-muted', 'bg-secondary',
                    'rounded', 'shadow', 'border-0'
                ];

                utilityClasses.forEach(className => {
                    expect(className).toBeTruthy();
                    expect(className).not.toContain('custom-');
                });
            });
        });

        async function runAllTests() {
            await testRunner.runTests();
        }

        // Run tests on page load
        window.onload = () => {
            setTimeout(runAllTests, 500);
        };
    </script>
</body>
</html>